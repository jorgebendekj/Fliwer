!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,r){Object.defineProperty(e,t,{get:a,set:r,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirecbf3,r=a.register;r("aUuqL",(function(r,o){t(r.exports,"ConnectedExpander",(function(){return c}));var n=a("fPPqr"),s=a("9nHZC"),i=a("kqytH"),l=a("dqY9c"),u=a("bik9K"),d=a("2X91Y");const c=({localStorageKey:t,onChange:a,defaultIsCollapsed:r,...o})=>{const{isCardCollapsed:c,setIsCardCollapsed:f}=(0,u.useIsCardCollapsed)({localStorageKey:t,defaultIsCardCollapsed:r}),{path:p}=(0,l.useMatch)(),g=p.startsWith(d.PR_PATH),m=(0,s.useCallback)((e=>{void 0!==a&&a(e),f(e)}),[a,f]);return e(s).createElement(i.default,e(n)({isCollapsed:c,onChange:m,localStorageKey:t,isPrPage:g},o))}})),r("bik9K",(function(e,r){t(e.exports,"useIsCardCollapsed",(function(){return l}));var o=a("9nHZC"),n=a("dGzLf"),s=a("e2kK7"),i=a("h3kk7");const l=({localStorageKey:e,defaultIsCardCollapsed:t=!1})=>{const a=i.default.get(e,void 0);let r=(0,n.useSelector)((t=>(0,s.getIsCardCollapsed)(t,e)));void 0===r&&(r=void 0===a?t:a);const l=(0,n.useDispatch)(),u=(0,o.useCallback)((t=>t.isCollapsed?l((0,s.collapseCard)(e)):l((0,s.expandCard)(e))),[l,e]);return(0,o.useEffect)((()=>{i.default.set(e,r)}),[e,r]),(0,o.useEffect)((()=>{u({isCollapsed:r})}),[]),{isCardCollapsed:r,setIsCardCollapsed:u}}})),r("7Vqk1",(function(r,o){t(r.exports,"BuildStatusCard",(function(){return S}));var n=a("fPPqr"),s=a("9nHZC"),i=a("agjvf"),l=a("EKmRU"),u=a("3THTN"),d=a("jeexd"),c=a("94iOw"),f=a("a7A34"),p=a("9ovwz"),g=a("aUuqL"),m=a("bb66M"),h=a("d9fDf"),b=a("fM6HV"),E=a("bqc1A");class C extends s.PureComponent{constructor(...t){super(...t),this.renderLabels=()=>{const{buildStatusResult:{builds:t},intl:a}=this.props,{FAILED:r,SUCCESSFUL:o}=(0,E.getBuildStatuses)(t);if(0===t.length){const t=0;return{rich:e(s).createElement(i.FormattedMessage,e(n)({},m.default.zeroBuilds,{values:{formattedCount:e(s).createElement("strong",null,t)}})),plain:a.formatMessage(m.default.zeroBuilds,{formattedCount:t})}}if(r){const o=`${r} of ${t.length}`;return{rich:e(s).createElement(i.FormattedMessage,e(n)({},m.default.failedStatus,{values:{total:t.length,formattedCount:e(s).createElement("strong",null,o)}})),plain:a.formatMessage(m.default.failedStatus,{total:t.length,formattedCount:o})}}const l=`${o} of ${t.length}`;return{rich:e(s).createElement(i.FormattedMessage,e(n)({},m.default.passedStatus,{values:{total:t.length,formattedCount:e(s).createElement("strong",null,l)}})),plain:a.formatMessage(m.default.passedStatus,{total:t.length,formattedCount:l})}},this.renderExpanderContent=()=>{const{builds:t,hasError:a,refetch:r,repositoryFullSlug:o,hasStatuses:n}=this.props.buildStatusResult;return a?e(s).createElement(p.default,{iconType:"warning",title:e(s).createElement(i.FormattedMessage,m.default.errorHeading)},e(s).createElement(l.default,{appearance:"link",onClick:r},e(s).createElement(i.FormattedMessage,m.default.errorAction))):t.length?e(s).createElement(f.BuildSummary,{builds:t}):o&&!n?e(s).createElement(h.default,{repositoryFullSlug:o}):null}}render(){const{isCollapsed:t,intl:a,buildStatusResult:{isLoading:r}}=this.props,{plain:o,rich:n}=this.renderLabels(),i=e(s).createElement(e(d),{label:""});return t?e(s).createElement(c.default,{position:"left",content:o},e(s).createElement(u.default,{appearance:"subtle",iconBefore:i})):e(s).createElement(g.ConnectedExpander,{localStorageKey:"build.card.collapsed",icon:i,dataTestId:"build-status-card",isLoading:r,label:n,sectionAriaLabel:a.formatMessage(m.default.sectionAriaLabel),headingAriaLabel:o},this.renderExpanderContent())}}C.defaultProps={isCollapsed:!1};const S=(0,i.injectIntl)((0,b.withBuildStatus)(C))})),r("bb66M",(function(e,r){t(e.exports,"default",(function(){return o}));var o=(0,a("agjvf").defineMessages)({sectionAriaLabel:{id:"repository.buildStatus.sectionAriaLabel",defaultMessage:"Build statuses"},failedStatus:{id:"repository.buildStatus.tooltipFailed",defaultMessage:"{total, plural, one {{formattedCount} build} other {{formattedCount} builds}} failed"},passedStatus:{id:"repository.buildStatus.tooltipSuccess",defaultMessage:"{total, plural, one {{formattedCount} build passed} other {{formattedCount} builds passed}}"},zeroBuilds:{id:"repository.buildStatus.zeroBuilds",defaultMessage:"{formattedCount} builds"},errorHeading:{id:"repository.buildStatus.error.heading",defaultMessage:"Couldn't load builds"},errorAction:{id:"repository.buildStatus.error.action",defaultMessage:"Try again"}})})),r("d9fDf",(function(r,o){t(r.exports,"default",(function(){return n}));var n,s=a("fPPqr"),i=a("9nHZC"),l=a("agjvf"),u=a("kZnTB"),d=a("4pNi0"),c=a("8v97y"),f=a("ca2jX");n=class extends i.PureComponent{render(){const[t,a]=this.props.repositoryFullSlug.split("/");return e(i).createElement(i.Fragment,null,e(i).createElement(c.PipelinesPromotionIcon,{alt:"Code emerging from a folder, with a green tick implying it's correctly working.",height:"104",src:e(f)}),e(i).createElement(c.PipelinesPromotionRow,null,e(i).createElement(l.FormattedMessage,e(s)({},d.default.promotionLineOne,{values:{bitbucketPipelinesDocumentation:e(i).createElement("a",{target:"_blank",href:"https://confluence.atlassian.com/bitbucket/get-started-with-bitbucket-pipelines-792298921.html"},e(i).createElement(l.FormattedMessage,d.default.promotionPipelinesDocumentationLink))}}))),e(i).createElement(c.PipelinesPromotionRow,null,e(i).createElement(l.FormattedMessage,d.default.promotionLineTwo)),e(i).createElement(c.PipelinesPromotionLink,null,e(i).createElement("a",{href:u.default.ui.pipelines(t,a)},e(i).createElement(l.FormattedMessage,d.default.promotionSetUpBitbucketPipelinesLink))))}}})),r("4pNi0",(function(e,r){t(e.exports,"default",(function(){return o}));var o=(0,a("agjvf").defineMessages)({promotionLineOne:{id:"frontbucket.repository.source.promotionLineOne",defaultMessage:"It looks like you haven\u2019t configured a build tool yet. You can use {bitbucketPipelinesDocumentation} to build, test and deploy your code."},promotionLineTwo:{id:"frontbucket.repository.source.promotionLineTwo",defaultMessage:"Your existing plan already includes build minutes."},promotionSetUpBitbucketPipelinesLink:{id:"frontbucket.repository.source.promotionSetUpBitbucketPipelinesLink",defaultMessage:"Set up a pipeline"},promotionPipelinesDocumentationLink:{id:"frontbucket.repository.source.promotionPipelinesDocumentationLink",defaultMessage:"Bitbucket Pipelines"}})})),r("8v97y",(function(e,r){t(e.exports,"PipelinesPromotionIcon",(function(){return l})),t(e.exports,"PipelinesPromotionRow",(function(){return u})),t(e.exports,"PipelinesPromotionLink",(function(){return d}));var o=a("2xJU3"),n=a("jp7ng"),s=a("aP6k3"),i=a("h39Sh");const l=(0,o.default)("img",{target:"e1jexyus0"})({name:"68vl60",styles:"margin:12px auto 22px auto;display:block;height:100px;"}),u=(0,o.default)("p",{target:"e1jexyus1"})("margin-bottom:",s.gridSize,";text-align:left;padding:0 ",(0,s.gridSize)()/2,"px;"),d=(0,o.default)("p",{target:"e1jexyus2"})("margin-top:",2*(0,s.gridSize)(),"px;text-align:center;border-top:1px solid ",(0,i.default)("color.border",n.N40A),";padding:",(0,s.gridSize)(),"px;")})),r("ca2jX",(function(e,t){e.exports=a("1sJKT").getBundleURL("3mxf9")+"pipelines-promotion-icon.8b4bf826.png"})),r("1sJKT",(function(e,a){var r,o;t(e.exports,"getBundleURL",(function(){return r}),(function(e){return r=e})),t(e.exports,"getOrigin",(function(){return o}),(function(e){return o=e}));var n={};function s(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(e){var t=n[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return s(e[2])}return"/"}(),n[e]=t),t},o=function(e){var t=(""+e).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}})),r("fM6HV",(function(r,o){t(r.exports,"BuildStatusProvider",(function(){return c})),t(r.exports,"withBuildStatus",(function(){return f}));var n=a("fPPqr"),s=a("9nHZC"),i=a("dGzLf"),l=a("1EkdU"),u=a("Ek4uG");const d=(0,s.createContext)(null),c=({repositoryMetadataURL:t,buildStatusURL:a,repositoryFullSlug:r,children:o})=>{const{builds:n,hasStatuses:c,isLoading:f,hasError:p,refetch:g}=(({repositoryMetadataURL:e,buildStatusURL:t})=>{const{data:a,isLoading:r,hasError:o,refetch:n}=(0,u.useAuthRequest)({url:e}),{data:d,isLoading:c,hasError:f,fetchData:p,clearData:g}=(0,u.useAuthRequestLazy)({url:t}),m=(null==a?void 0:a.has_statuses)||!1,h=(null==d?void 0:d.values)||[],b=f||o,E=c||r,C=(0,i.useSelector)(l.getPullRequestRefetchBuildsDummy);(0,s.useEffect)((()=>{m?p():g()}),[p,g,m,C]);const S=(0,s.useCallback)((()=>{n(),g()}),[n,g]);return{builds:h,hasStatuses:m,isLoading:E,hasError:b,refetch:S}})({repositoryMetadataURL:t,buildStatusURL:a}),m=(0,s.useMemo)((()=>({builds:n,hasStatuses:c,isLoading:f,hasError:p,refetch:g,repositoryFullSlug:r})),[n,c,f,p,g,r]);return e(s).createElement(d.Provider,{value:m},o)},f=t=>a=>{const r=(()=>{const e=(0,s.useContext)(d);if(null===e)throw new Error("useBuildStatus requires a parent BuildStatusProvider");return e})();return e(s).createElement(t,e(n)({buildStatusResult:r},a))}})),r("Ek4uG",(function(e,r){t(e.exports,"useAuthRequestLazy",(function(){return s})),t(e.exports,"useAuthRequest",(function(){return i}));var o=a("9nHZC"),n=a("k2cPS");const s=({url:e})=>{const[{data:t,isLoading:a,hasError:r},s]=(0,o.useState)({data:null,isLoading:!0,hasError:!1}),i=(0,o.useCallback)((()=>{s({isLoading:!1,hasError:!1,data:null})}),[s]);return{data:t,isLoading:a,hasError:r,fetchData:(0,o.useCallback)((async()=>{if(!e)return;s({isLoading:!0,hasError:!1,data:null});const t=await fetch((0,n.default)(e));if(t.ok)try{s({isLoading:!1,hasError:!1,data:await t.json()})}catch(e){s({data:null,hasError:!0,isLoading:!1})}else s({data:null,isLoading:!1,hasError:!0})}),[e]),clearData:i}},i=({url:e})=>{const{data:t,isLoading:a,hasError:r,fetchData:n,clearData:i}=s({url:e});(0,o.useEffect)((()=>{n()}),[n]);return{data:t,isLoading:a,hasError:r,refetch:(0,o.useCallback)((()=>{i(),n()}),[i,n]),clearData:i}}})),r("bqc1A",(function(e,a){function r(e){return e.reduce(((e,t)=>(e[t.state]+=1,e)),{FAILED:0,INPROGRESS:0,STOPPED:0,SUCCESSFUL:0})}t(e.exports,"getBuildStatuses",(function(){return r}))}))}();
//# sourceMappingURL=source-diff.105f40b1.js.map
