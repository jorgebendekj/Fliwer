!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,l,a){Object.defineProperty(e,t,{get:l,set:a,enumerable:!0,configurable:!0})}var l=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirecbf3,a=l.register;a("2QZwm",(function(a,n){var r;r=a.exports,Object.defineProperty(r,"__esModule",{value:!0,configurable:!0}),t(a.exports,"globalThemeKey",(function(){return S})),t(a.exports,"getTheme",(function(){return w})),t(a.exports,"default",(function(){return D}));var o=l("9nHZC"),u=l("3THTN"),i=l("7S5Ao"),s=l("cDEfn"),c=l("cGedL"),d=l("cGPG3"),f=l("ljrFr"),p=l("2X56B"),b=l("DPG6Z"),m=l("3qXIy"),v=l("2FnXC"),g=l("lepT7"),h=l("4AJu4"),E=l("8Ati6"),k=l("bijGW"),y=l("86hZh"),x=l("4Qrev"),C=l("h3kk7");const S="bitbucket.global.theme",w=()=>C.default.get(S)||"light",T=()=>{const e=(0,y.getCookie)("bbc-frontbucket-version");if(!e)return"server";if(!e)return"server";if("local"===e)return"local";if("canary"===e)return"canary";if("experiment"===e)return"experiment";const t=/(\d+)(exp)?/.exec(e);if(t){const e=parseInt(t[1],10);return[t[2]?"pr-experiment":"pr",e]}return"server"},P=()=>{const e=(0,y.getCookie)("bbc-frontbucket-pipelines-env");return"ddev"===e||"stg-west"===e?e:""};function D(){const t=T();let l="server";const a=P();let n="";const r=window.location.pathname.match(/^\/bitbucket\/frontbucket\/pull-requests\/(\d+)/);r&&(n=r[1]),"local"===t||"canary"===t||"experiment"===t?l=t:Array.isArray(t)&&(l=t[0],n=`${t[1]}`);const[y,D]=(0,o.useState)(!1),[j,q]=(0,o.useState)(l),[I,F]=(0,o.useState)(a),[G,N]=(0,o.useState)(w()),[V,A]=(0,o.useState)(n),[L,Z]=(0,o.useState)(void 0);(0,E.default)({colorMode:G});const _=document.getElementById("settings-frame"),B=null==_?void 0:_.contentWindow;B&&"function"==typeof B.setTheme&&B.setTheme(G);const H=()=>D(!1),M=[{label:"Local",value:"local"},{label:"Canary",value:"canary"},{label:"Experiment",value:"experiment"},{label:"Pull request",value:"pr"},{label:"Pull request (experimental)",value:"pr-experiment"},{label:"Current server",value:"server"}],O=[{label:"Session",value:void 0},{label:"1 hour",value:3600}],W=[{label:"DDev",value:"ddev"},{label:"Staging",value:"stg-west"},{label:"Production",value:""}],z=[{label:"Light",value:"light"},{label:"Dark",value:"dark"}];return e(o).createElement(e(o).Fragment,null,e(o).createElement(v.default,null,y&&e(o).createElement(d.default,{onClose:H},e(o).createElement(b.default,null,e(o).createElement(m.default,null,"Frontbucket dev assets")),e(o).createElement(f.default,null,e(o).createElement(i.default,{name:"location",label:"Load assets from"},(()=>e(o).createElement(g.default,{options:M,defaultValue:M.find((e=>e.value===l)),isSearchable:!1,onChange:e=>{e&&"value"in e&&q(e.value)}}))),e(o).createElement(i.default,{name:"pullrequestId",label:"Pull request ID"},(()=>e(o).createElement(h.default,{isDisabled:!("pr"===j||"pr-experiment"===j),placeholder:"5271",value:V,onChange:e=>A(e.currentTarget.value)}))),e(o).createElement(i.default,{name:"pipelinesEnv",label:"Pipelines Environment"},(()=>e(o).createElement(g.default,{options:W,defaultValue:W.find((e=>e.value===a)),isSearchable:!1,onChange:e=>{e&&"value"in e&&F(e.value)}}))),e(o).createElement(i.default,{name:"expiration",label:"Expire after"},(()=>e(o).createElement(g.default,{isDisabled:"server"===j,isSearchable:!1,options:O,defaultValue:O[0],onChange:e=>{e&&"value"in e&&Z(e.value)}}))),e(o).createElement(i.default,{name:"mode",label:"Color mode"},(()=>e(o).createElement(g.default,{options:z,defaultValue:z.find((e=>e.value===G))||z[0],onChange:e=>{e&&"value"in e&&(N(e.value),C.default.set(S,e.value))}}))),e(o).createElement("p",null,"In order to use local assets, you need to run parcel with HTTPS support."),e(o).createElement("pre",null,e(o).createElement("code",null,"yarn start --https")),e(o).createElement("p",null,"You\u2019ll also need to manually accept the self-signed certificate from parcel."),e(o).createElement("p",null,e(o).createElement("a",{href:"https://localhost:3000/static/vendor.css",target:"_blank"},"View local assets"))),e(o).createElement(p.default,null,e(o).createElement(u.default,{appearance:"primary",onClick:()=>{"local"===j||"canary"===j||"experiment"===j?(0,x.setStrictlyNecessaryCookie)("bbc-frontbucket-version",j,{path:"/",expires:L}):"pr"===j?(0,x.setStrictlyNecessaryCookie)("bbc-frontbucket-version",V,{path:"/",expires:L}):"pr-experiment"===j?(0,x.setStrictlyNecessaryCookie)("bbc-frontbucket-version",`${V}exp`,{path:"/",expires:L}):(0,k.deleteCookie)("bbc-frontbucket-version"),"ddev"===I||"stg-west"===I?(0,x.setStrictlyNecessaryCookie)("bbc-frontbucket-pipelines-env",I,{path:"/",expires:L}):(0,k.deleteCookie)("bbc-frontbucket-pipelines-env"),window.location.reload()},autoFocus:!0},"Make it so"),e(o).createElement(u.default,{onClick:H},"Cancel")))),e(o).createElement("div",{style:{position:"fixed",right:16,bottom:16,zIndex:1e5}},e(o).createElement(u.default,{iconBefore:"server"!==t||P()?e(o).createElement(e(c),{size:"small",label:"Toggle dev assets"}):e(o).createElement(e(s),{size:"small",label:"Toggle dev assets"}),onClick:()=>{D(!y)}})))}})),a("bijGW",(function(a,n){t(a.exports,"deleteCookie",(function(){return s}));var r=l("1Qo9y"),o=l("lHRVb"),u=l("jtYt3"),i=l("JZBNd"),s=function(t,l){try{(0,o.fg)("platform.moonjelly.browser-storage-controls")&&(0,u.sendPackageOperationalEvent)({action:"usedDeleteCookie",attributes:{cookieKey:t}}),e(r).remove(t,l)}catch(e){i.Logger.errorWithOperationalEvent({action:"usedDeleteCookieError",attributes:{cookieKey:t},message:"Failed to use delete cookie. ".concat(e.message||"")})}}}))}();
//# sourceMappingURL=version-dialog.8607655c.js.map
