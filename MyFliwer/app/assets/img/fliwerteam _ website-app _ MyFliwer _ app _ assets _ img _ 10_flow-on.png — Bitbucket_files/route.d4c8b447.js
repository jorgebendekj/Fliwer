!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequirecbf3,r=n.register;r("iJngd",(function(t,r){e(t.exports,"default",(function(){return i}));var a=n("fequ0"),l=n("6Ef7A"),i=(e,t)=>{const{author:n,participants:r}=e,i=r.filter((e=>(0,l.isReviewer)(e)&&(0,l.isNotAuthor)(e,n))),o=i.filter((e=>e.state===a.ParticipantStateTypes.changesRequested)),s=i.filter((e=>e.approved||e.state===a.ParticipantStateTypes.approved)),u=i.filter((e=>!e.state));if(t){const e=e=>e.user&&e.user.uuid===t,n=t=>{t.findIndex(e)&&t.sort(((t,n)=>e(t)?-1:e(n)?1:0))};n(o),n(s),n(u)}return[...o,...s,...u]}})),r("c5abK",(function(t,r){e(t.exports,"BranchInfoDialog",(function(){return n("43Trd").default}));n("43Trd"),n("aSNzx"),n("50pHH")})),r("43Trd",(function(r,a){e(r.exports,"default",(function(){return h}));var l=n("fPPqr"),i=n("9nHZC"),o=n("agjvf"),s=n("93cMI"),u=n("4tAgz"),c=n("hvciF"),d=n("aSNzx"),f=n("a4eff"),p=n("jae5r"),g=n("5Z53j");class m extends i.PureComponent{constructor(...e){super(...e),this.state={isOpen:!1},this.getBranchName=()=>{const{branchName:e}=this.props;return e},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleKeyDown=e=>{" "!==e.key&&"Enter"!==e.key||(this.toggleDialog(),e.preventDefault())},this.toggleDialog=()=>{this.setState((e=>({isOpen:!e.isOpen})))}}render(){const{branchHref:e,branchName:n,repoOwnerAvatarSrc:r,repoOwnerHref:a,repoOwnerName:m,repoAvatarSrc:h,repoHref:b,repoName:x,description:v,tabIndex:C,supportsRetargeting:L,intl:k}=this.props,y=t(i).createElement(g.BranchInfoPopupContent,null,t(i).createElement(f.BranchInfo,{branchHref:e,branchName:n,repoAvatarSrc:h,repoHref:b,repoName:x,repoOwnerAvatarSrc:r,repoOwnerHref:a,repoOwnerName:m,supportsRetargeting:L,closeBranchInfo:this.handleClose}),t(i).createElement(c.default,{refName:this.getBranchName()}));return t(i).createElement(s.Popup,{placement:"bottom-start",content:()=>y,isOpen:this.state.isOpen,onClose:this.handleClose,trigger:e=>{const{ref:n}=e;return t(i).createElement(g.PopupChildrenWrapper,t(l)({},e,{ref:n,role:"button",onClick:this.toggleDialog,onKeyDown:this.handleKeyDown,tabIndex:C||0,"aria-label":L?k.formatMessage(p.default.changeDestinationBranchLabel):""}),t(i).createElement(u.ScreenReadersOnly,null,t(i).createElement(o.FormattedMessage,t(l)({},p.default.branchLabel,{values:{branchName:v}}))),t(i).createElement(d.default,{ariaHidden:!0,name:v}))}})}}m.defaultProps={};var h=(0,o.injectIntl)(m)})),r("a4eff",(function(r,a){e(r.exports,"BranchInfo",(function(){return y}));var l=n("9nHZC"),i=n("dGzLf"),o=n("inFLm"),s=n("3THTN"),u=n("dWDB7"),c=n("jjNOu"),d=n("jajUg"),f=n("jnhui"),p=n("1EkdU"),g=n("kh0W2"),m=n("5gF7V"),h=n("abRa1"),b=n("aqOOe"),x=n("iBE3U"),v=n("bTM9L"),C=n("6aoKW"),L=n("78aj9"),k=n("4zQum");const y=({branchHref:e,branchName:n,repoAvatarSrc:r,repoHref:a,repoName:y,repoOwnerAvatarSrc:E,repoOwnerHref:S,repoOwnerName:w,supportsRetargeting:R=!1,closeBranchInfo:q})=>{const z=(0,d.useIntl)(),B=(0,i.useSelector)(p.getCurrentPullRequestSourceBranchDetails),N=(0,f.useCheckUserAccess)("write"),[O,M]=(0,l.useState)({name:n,type:m.REF_TYPE.BRANCH}),{retargetPullRequest:P}=(0,v.useRetargetPullRequest)(),{fetchRefs:H,fetchNextRefs:I,state:j}=(0,x.useRefFetchActions)({sourceBranch:null==B?void 0:B.name});(0,l.useEffect)((()=>{H()}),[O,H]);const D=e=>{(0,C.publishUiEvent)({action:"clicked",actionSubject:"button",actionSubjectId:e,source:"branchInfo"})},U=e=>t(l).createElement(k.BranchInfoListItem,null,t(l).createElement(k.LeftColumn,{"aria-hidden":"true"},e.leftColumnContent),t(l).createElement(k.RightColumn,null,e.rightColumnContent)),A=()=>{const e=(0,h.getRef)({name:n});M(e)},T=()=>{O.name!==n&&((0,C.publishUiEvent)({action:"clicked",actionSubject:"button",actionSubjectId:"retarget",source:"prView"}),q&&q(),P(O.name))},F=()=>t(l).createElement(k.ReadContainer,null,t(l).createElement(k.LinkContainer,null,t(l).createElement(g.default,{to:e||"",onClick:()=>D("branchHref"),"aria-label":z.formatMessage(L.default.openLinkLabel,{name:n,type:"branch"}),"data-testid":"branch-info-read"},t(l).createElement(k.LinkTextContainer,null,t(l).createElement(k.LinkTextSpan,null,n)))),t(l).createElement(k.Icon,null,t(l).createElement(t(u),{label:""}))),W=()=>t(l).createElement(k.EditContainer,null,t(l).createElement(b.BranchSelector,{branchSelector:j,value:{label:O.name,value:O.name},onChangeBranch:M,fetchRefOptions:H,fetchNextRefOptions:I,autoFocus:!0,startMenuOpen:!0}));return t(l).createElement(k.BranchInfoList,{role:"list"},(()=>{if(!w)return null;const e=t(l).createElement(o.default,{name:w,size:"small",src:E}),n={leftColumnContent:z.formatMessage(L.default.repoWorkspaceLabel),rightColumnContent:S?t(l).createElement(s.default,{appearance:"link",href:S,onClick:()=>D("repoOwnerHref"),type:null,iconBefore:e,"aria-label":z.formatMessage(L.default.openLinkLabel,{name:w,type:"workspace"})},w):t(l).createElement(k.FormerUser,null,t(l).createElement(k.FormerUserAvatar,null,e),t(l).createElement(k.FormerUserName,null,w))};return U(n)})(),(()=>{const e={leftColumnContent:z.formatMessage(L.default.repoNameLabel),rightColumnContent:t(l).createElement(s.default,{appearance:"link",isDisabled:!y,href:a,onClick:()=>D("repoHref"),type:null,iconBefore:t(l).createElement(o.default,{name:y,src:r,size:"small"}),"aria-label":y?z.formatMessage(L.default.openLinkLabel,{name:y,type:"repository"}):void 0},y||z.formatMessage(L.default.deletedRepository))};return U(e)})(),(()=>{const r=!!R&&N&&!!B,a={leftColumnContent:z.formatMessage(L.default.branchLabel),rightColumnContent:r?t(l).createElement(k.RetargetBranch,null,t(l).createElement(c.default,{defaultValue:n,readViewFitContainerWidth:!0,keepEditViewOpenOnBlur:!0,editView:W,readView:F,onConfirm:T,onCancel:A})):t(l).createElement(s.default,{appearance:"link",href:e,onClick:()=>D("branchHref"),type:null,isDisabled:!e,"aria-label":z.formatMessage(L.default.openLinkLabel,{name:n,type:"branch"})},n)};return U(a)})())}})),r("jnhui",(function(t,r){e(t.exports,"useCheckUserAccess",(function(){return s}));var a=n("dGzLf"),l=n("1EkdU"),i=n("6SlIf"),o=n("aanBq");const s=e=>{const t=(0,a.useSelector)(o.getRepositoryAccessLevel),n=(0,a.useSelector)(l.getSourceRepositoryAccessLevel);let r=(0,i.checkUserAccess)({userLevel:t,requiredLevel:e});return r||(r=(0,i.checkUserAccess)({userLevel:n||"read",requiredLevel:e})),r}})),r("bTM9L",(function(t,r){e(t.exports,"useRetargetPullRequest",(function(){return d}));var a=n("9nHZC"),l=n("dGzLf"),i=n("2kKDW"),o=n("24sAG"),s=n("1EkdU"),u=n("czBtW"),c=n("k2cPS");const d=()=>{const e=(0,l.useDispatch)(),{owner:t,slug:n,id:r}=(0,l.useSelector)(s.getCurrentPullRequestUrlPieces);return{retargetPullRequest:(0,a.useCallback)((async a=>{if(!(t&&n&&r&&a))return;const l=u.default.api.v20.pullRequest(t,n,r);try{const t=(0,c.default)(l,{method:"PUT",headers:c.jsonHeaders,body:JSON.stringify({destination:{branch:{name:a}}})});if(!(await fetch(t)).ok)throw Error("Error retargeting PR");e((0,i.showFlagComponent)("pull-request-retarget-success",{componentId:"pull-request-retarget-success",props:{branchName:a}})),e((0,o.refreshCodeReviewData)({needsDiff:!0,needsPullRequest:!0,needsComments:!0,needsTasks:!1,forceNeedsMergeChecks:!0}))}catch(t){e((0,i.showFlagComponent)("pull-request-retarget-error"))}}),[e,t,n,r])}}})),r("78aj9",(function(t,r){e(t.exports,"default",(function(){return a}));var a=(0,n("agjvf").defineMessages)({repoOwnerLabel:{id:"bitkit.refLabel.repoOwnerLabel",defaultMessage:"Owner"},repoWorkspaceLabel:{id:"bitkit.refLabel.repoWorkspaceLabel",defaultMessage:"Workspace"},repoNameLabel:{id:"bitkit.refLabel.repoNameLabel",defaultMessage:"Repository"},branchLabel:{id:"bitkit.refLabel.branchLabel",defaultMessage:"Branch"},deletedRepository:{id:"bitkit.refLabel.deletedRepository",defaultMessage:"Deleted repository"},openLinkLabel:{id:"bitkit.refLabel.openLink",defaultMessage:"{name}, {type}"}})})),r("4zQum",(function(t,r){e(t.exports,"BranchInfoList",(function(){return o})),e(t.exports,"BranchInfoListItem",(function(){return s})),e(t.exports,"LeftColumn",(function(){return u})),e(t.exports,"RightColumn",(function(){return c})),e(t.exports,"FormerUser",(function(){return d})),e(t.exports,"FormerUserAvatar",(function(){return f})),e(t.exports,"FormerUserName",(function(){return p})),e(t.exports,"RetargetBranch",(function(){return g})),e(t.exports,"ReadContainer",(function(){return m})),e(t.exports,"EditContainer",(function(){return h})),e(t.exports,"LinkContainer",(function(){return b})),e(t.exports,"LinkTextContainer",(function(){return x})),e(t.exports,"LinkTextSpan",(function(){return v})),e(t.exports,"Icon",(function(){return C}));var a=n("2xJU3"),l=n("aP6k3"),i=n("dCDrX");const o=(0,a.default)("ul",{target:"e7nqrxv0"})("padding-left:0;list-style:none;display:table;margin-bottom:",2*(0,l.gridSize)(),"px;"),s=(0,a.default)("li",{target:"e7nqrxv1"})({name:"ds3kc",styles:"display:table-row;"}),u=(0,a.default)("div",{target:"e7nqrxv2"})("display:table-cell;text-align:right;",i.h200(),";padding-right:0;vertical-align:middle;padding-top:",(0,l.gridSize)()/2,"px;padding-bottom:",(0,l.gridSize)()/2,"px;"),c=(0,a.default)("div",{target:"e7nqrxv3"})("display:table-cell;vertical-align:middle;max-width:",51*(0,l.gridSize)(),"px;padding-left:",(0,l.gridSize)(),"px;padding-top:",(0,l.gridSize)()/2,"px;padding-bottom:",(0,l.gridSize)()/2,"px;"),d=(0,a.default)("span",{target:"e7nqrxv4"})("align-items:center;display:flex;padding:",(0,l.gridSize)()/2,"px ",(0,l.gridSize)(),"px;"),f=(0,a.default)("span",{target:"e7nqrxv5"})("line-height:0;margin:0 ",(0,l.gridSize)()/2,"px;"),p=(0,a.default)("span",{target:"e7nqrxv6"})("margin:0 ",(0,l.gridSize)()/2,"px;"),g=(0,a.default)("div",{target:"e7nqrxv7"})({name:"18mudl3",styles:"margin-top:-8px;"}),m=(0,a.default)("div",{target:"e7nqrxv8"})({name:"6gei9z",styles:"display:inline-flex;align-items:center;width:100%;"}),h=(0,a.default)("div",{target:"e7nqrxv9"})("min-width:250px;max-width:",51*(0,l.gridSize)(),"px;"),b=(0,a.default)("div",{target:"e7nqrxv10"})("margin:0 4px;padding:0 8px;max-width:",51*(0,l.gridSize)()-52,"px;"),x=(0,a.default)("div",{target:"e7nqrxv11"})("display:flex;white-space:nowrap;max-width:",51*(0,l.gridSize)()-28,"px;"),v=(0,a.default)("span",{target:"e7nqrxv12"})({name:"v2ed92",styles:"overflow:hidden;text-overflow:ellipsis;font-weight:500;font-style:normal;"}),C=(0,a.default)("div",{target:"e7nqrxv13"})({name:"15siaf2",styles:"margin-left:auto;margin-right:0;padding-right:4px;"})})),r("jae5r",(function(t,r){e(t.exports,"default",(function(){return a}));var a=(0,n("agjvf").defineMessages)({branchLabel:{id:"frontbucket.repository.pullRequest.branchLabel",defaultMessage:"Branch: {branchName}"},changeDestinationBranchLabel:{id:"frontbucket.repository.pullRequest.changeDestinationBranchLabel",defaultMessage:"Change destination branch"}})})),r("5Z53j",(function(t,r){e(t.exports,"BranchInfoPopupContent",(function(){return i})),e(t.exports,"PopupChildrenWrapper",(function(){return o}));var a=n("2xJU3"),l=n("aP6k3");const i=(0,a.default)("div",{target:"e7z7b1e0"})("display:flex;flex-direction:column;padding:",2*(0,l.gridSize)(),"px ",3*(0,l.gridSize)(),"px;"),o=(0,a.default)("div",{target:"e7z7b1e1"})({name:"1q59hjf",styles:"cursor:pointer;display:flex;"})})),r("50pHH",(function(e,t){var r=n("9nHZC"),a=n("dLTSq"),l=n("6qbSb");r.PureComponent})),r("6qbSb",(function(r,a){e(r.exports,"default",(function(){return c}));var l=n("fPPqr"),i=n("9nHZC"),o=n("57VDz"),s=n("bQrht");const u=()=>t(i).createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},t(i).createElement("title",null,"Tag Small"),t(i).createElement("g",{id:"Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},t(i).createElement("g",{id:"tag_small",stroke:"#42526E"},t(i).createElement("path",{d:"M3.5,4.70710678 L3.5,8.2773188 L7.96468888,12.2955388 L12.2920077,7.53548811 L7.808132,3.5 L4.70710678,3.5 L3.5,4.70710678 Z M6.5,7.5 C5.94771525,7.5 5.5,7.05228475 5.5,6.5 C5.5,5.94771525 5.94771525,5.5 6.5,5.5 C7.05228475,5.5 7.5,5.94771525 7.5,6.5 C7.5,7.05228475 7.05228475,7.5 6.5,7.5 Z"}))));var c=e=>t(i).createElement(o.default,t(l)({size:s.sizeMap.small,glyph:u},e))}))}();
//# sourceMappingURL=route.d4c8b447.js.map
